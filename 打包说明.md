# 暖心便签弹窗阵列 - 打包成 EXE 说明

## 方法一：使用 PyInstaller（推荐）

### 1. 安装 PyInstaller

由于您的网络环境可能有问题，可以尝试以下几种方式：

#### 方式 A：使用国内镜像源

```powershell
pip install pyinstaller -i https://pypi.tuna.tsinghua.edu.cn/simple
```

#### 方式 B：直接使用 Python 的 pip

```powershell
I:\anaconda3\python.exe -m pip install pyinstaller -i https://pypi.tuna.tsinghua.edu.cn/simple
```

#### 方式 C：下载离线安装包

1. 访问 https://pypi.org/project/pyinstaller/#files
2. 下载 `.whl` 文件（选择 Windows 对应版本）
3. 运行：`I:\anaconda3\python.exe -m pip install 下载的文件名.whl`

### 2. 打包命令

安装成功后，在当前目录运行：

```powershell
# 基础打包（单文件，带控制台窗口）
I:\anaconda3\python.exe -m PyInstaller --onefile "暖心便签弹窗阵列.py"

# 推荐打包（单文件，无控制台窗口）
I:\anaconda3\python.exe -m PyInstaller --onefile --noconsole "暖心便签弹窗阵列.py"

# 高级打包（自定义图标）
I:\anaconda3\python.exe -m PyInstaller --onefile --noconsole --icon=icon.ico "暖心便签弹窗阵列.py"
```

### 3. 输出位置

- 可执行文件：`dist\暖心便签弹窗阵列.exe`
- 打包日志和临时文件：`build\` 文件夹
- 配置文件：`暖心便签弹窗阵列.spec`

---

## 方法二：使用 cx_Freeze（备选）

如果 PyInstaller 无法安装，可以尝试 cx_Freeze：

### 1. 安装 cx_Freeze

```powershell
I:\anaconda3\python.exe -m pip install cx_Freeze -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 2. 创建 setup.py

```python
from cx_Freeze import setup, Executable

setup(
    name="暖心便签弹窗阵列",
    version="1.0",
    description="Birthday Popup Messages",
    executables=[Executable("暖心便签弹窗阵列.py", base="Win32GUI")]
)
```

### 3. 打包

```powershell
I:\anaconda3\python.exe setup.py build
```

---

## 方法三：使用 Nuitka（性能最优）

### 1. 安装 Nuitka

```powershell
I:\anaconda3\python.exe -m pip install nuitka -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 2. 打包

```powershell
I:\anaconda3\python.exe -m nuitka --standalone --onefile --windows-disable-console "暖心便签弹窗阵列.py"
```

---

## 测试打包后的程序

```powershell
# 运行生成的 exe（测试模式 - 5个弹窗）
.\dist\暖心便签弹窗阵列.exe --test

# 运行生成的 exe（完整模式 - 200个弹窗）
.\dist\暖心便签弹窗阵列.exe

# 自定义弹窗数量
.\dist\暖心便签弹窗阵列.exe --count 50

# 调整弹窗间隔（毫秒）
.\dist\暖心便签弹窗阵列.exe --count 100 --stagger 100
```

---

## 常见问题

### Q1：打包后 exe 文件很大？

- PyInstaller 会打包整个 Python 解释器和依赖库，通常 10-50MB
- 这是正常的，可以使用 UPX 压缩：`pyinstaller --onefile --noconsole --upx-dir=UPX路径 暖心便签弹窗阵列.py`

### Q2：杀毒软件报毒？

- 这是误报，PyInstaller 打包的程序经常被杀毒软件标记
- 可以添加到白名单，或使用代码签名证书

### Q3：打包失败？

- 确保脚本本身可以运行：`I:\anaconda3\python.exe "暖心便签弹窗阵列.py" --test`
- 检查是否有隐藏的导入错误
- 尝试添加 `--hidden-import=tkinter` 参数

### Q4：exe 无法在其他电脑运行？

- 使用 `--onefile` 确保打包为单文件
- 确保目标电脑是 64 位 Windows（如果您的环境是 64 位）

---

## 当前环境信息

- Python 版本：3.8.8
- Python 路径：I:\anaconda3\python.exe
- 环境类型：Conda base
- tkinter：已内置（无需额外安装）

---

## 快速开始

如果网络正常，直接运行：

```powershell
cd "i:\桌面\suibian"
I:\anaconda3\python.exe -m pip install pyinstaller -i https://pypi.tuna.tsinghua.edu.cn/simple
I:\anaconda3\python.exe -m PyInstaller --onefile --noconsole "暖心便签弹窗阵列.py"
```

完成后，您的 exe 文件将位于：`i:\桌面\suibian\dist\暖心便签弹窗阵列.exe`
